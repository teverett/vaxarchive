<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<head><title>PPP on NetBSD/VAX</title></head>
<body bgcolor="#FFFFFF">
<h1>PPP on NetBSD/VAX</h1>
<p>I put this together for Gunnar awhile back in September.
<BR>I have not seen it posted on the FAQ yet, I know time slips away on
me so I am not throwing rocks but if anyone else out there can benefit....
<P>Intended for the FAQ:
<P><FONT COLOR="#FF0000">5.5.1 Can I run PPP on NetBSD/VAX yet and if so
how?</FONT>
<P>A: Yes, Depending on your hardware configuration, if you're running
V1.1 or later (serial line support is now included). If you're running
V1.0A you're out of luck though:
<P>Specifically, it depends on which Asynchronous Mux you are running.&nbsp;
It can be done. Easily -when you look back on it. It seems a little confusing
at first.
<P>The following section describes a successful set up!
<P><FONT COLOR="#000099">Credit for the next section really belongs to
the folks who always seem</FONT>
<BR><FONT COLOR="#000099">to help me: Ronny Svedman., Erno Palonheimo,
John Wilson , Emannuel Dreyfus, David Brownlee, J.S. Havard, Dave McGuire,
Jonas Oberg, Carl Lowenstien, der Mouse, Ken Wellsch, Geoff Roberts, J.
Buck Caldwell, Jamie Lovick, Tom Ivar Helbekkmo, Hubert Feyrer, Jim Bender
(who put the DHV specs online to help), Johnny Billquist,</FONT>
<BR><FONT COLOR="#000099">Ragge, and of course Gunnar Helliesen,</FONT>
<P><FONT COLOR="#FF0000">5.5.1.1 Is there a working example of how to set
up PPP on NetBSD VAX?</FONT><FONT COLOR="#FF0000"></FONT>
<P>YES! Here is a configuration that works (uVaxII): KA630, 16MB mem, DEQNA,
DHV11 (M3106), CMD Scsi Interface, RQDX3, and TK50. I am running NetBSD
versions 1.3b and later versions (upto 1.3.2G).
<P>I did a MAKEDEV dhv and got the resulting ttyS0 on up to ttyS15 in /dev.
<BR>The modem is a GVC external 14.4.
<P><FONT COLOR="#33FF33">o </FONT>Mux Set Up - Or how do I know the mux
is working? DHV is compiled into
<BR>the kernel, I had to do a MAKEDEV though!.<FONT COLOR="#000099"></FONT>
<P><FONT COLOR="#000099">Speed is limited to 38.4Kb. See the Troubleshooting
section.</FONT>
<P><FONT COLOR="#33FF33">o</FONT> The address I set up was (the default
detected by netbsd): 7760440<FONT COLOR="#00CC00"></FONT>
<P><FONT COLOR="#00CC00">o</FONT> The switches looklike this: (to be provided)<FONT COLOR="#00CC00"></FONT>
<P><FONT COLOR="#00CC00">o</FONT> DHV to Bulkhead Connector Cables: DHV
has two 50-pin connectors. They are labeled TH1 and TH2. The cables can
be plugged to the board with the red stripe (pin1) up toward ceiling or
down toward the floor.
<P>The connector is layed out so that it does not injure the DHV if you
plug it in one way or the other. The four DB25 bulk head adapter connects
to the flat cable. I put it in so that
<BR>the cable connector is on the top, the red stripe is toward the right
(on top) and I have ttyS0 connection on the bottom set of the 4!!!!
<P>o Modem Cable - a straight thru modem cable that supports modem control
leads (i.e. DSR, DTR, RTS, CTS, CD, SD, RD, Ground, etc.) is what I used.
<P><FONT COLOR="#FF0000">o Directories and Files I set up:</FONT>
<P>/etc/ppp (directory)
<BR>/etc/ppp/chat-myisp (file)
<BR>/etc/ppp/peers (directory)
<BR>/etc/ppp/peers/myisp (file)
<P>The files I used that work with fixed IP addresses (more or less) (and
watch the quotation marks! Note that the commands have to be single quotes.):
<P><FONT COLOR="#000099">o chat-myisp file (in the /etc/ppp directory)</FONT>
<BR>#chat-myisp file
<BR>ABORT "NO CARRIER"
<BR>ABORT "NO DIALTONE"
<BR>ABORT "ERROR"
<BR>ABORT "NO ANSWER"
<BR>ABORT "BUSY"
<BR>ABORT "Username/Password Incorrect"
<BR>'' 'atz'
<BR>'OK' 'atdt##########'
<BR>'CONNECT' ''
<BR>'REPORT' 'CONNECT'
<BR>'TIMEOUT' '120'
<BR>'ogin:' 'xxxxxxxx'
<BR>'word:' 'xxxxxxxxxx'
<BR>'mode' 'ppp' &lt;Note that in this one I expect the response 'mode'
from my isp.
<P><FONT COLOR="#000099">o myisp file (with static IPs in the /etc/ppp/peers
directory)</FONT>
<BR>#myisp file /dev/ttyS0 38400 crtscts
<BR>23.1.1.16:23.1.10.254 <FONT COLOR="#00CC00">&lt;I used network 23 here
cause I like Max Headroom></FONT>
<BR>ipcp-accept-local ipcp-accept-remote
<BR>idle 120
<BR>connect '/usr/sbin/chat -v -f /etc/ppp/chat-myisp'
<BR>noauth
<P>(Remember: plug in your own IP addresses. I used the
<BR>ipcp-accept functions because my distant end changes occaisionally!).
<BR>===============
<P><FONT COLOR="#FF0000">And with Dynamic IP addressesing:</FONT>
<BR>#Dynamic IP chat-myisp file
<BR>ABORT "NO DIALTONE"
<BR>ABORT "ERROR"
<BR>ABORT "NO ANSWER"
<BR>ABORT "BUSY" ABORT "Username/Password Incorrect"
<BR>'' 'atz'
<BR>'OK' 'atdt##########'
<BR>'CONNECT' ''
<BR>'REPORT' 'CONNECT'
<BR>'TIMEOUT' '120'
<BR>'ogin:' 'xxxxxxxxxx'
<BR>'word:' 'xxxxxxxxx'
<BR>'TIMEOUT' '3'
<BR>'' 'ppp' &lt;note that there is no response specified in this line,
that
<BR>works with my
<BR>ISP, yours might be different!
<P><FONT COLOR="#009900"># Dynamic IP myisp file setup data</FONT>
<BR><FONT COLOR="#009900">ttyS0 38400 crtscts</FONT>
<BR>ipcp-accept-local
<BR>ipcp-accept-remote
<BR>connect '/usr/sbin/chat -v -f /etc/ppp/chat-myisp'
<BR>defaultroute
<BR>noauth
<P>o Routing
<BR>In the static IP example, I have the default route set up in my boot
up script.
<BR>In the dynamic IP example, I have default route function in the script.
<BR>I had to build my routes manually, I don't have arp or rip running.
<P>o What is missing/not done:
<BR>Connection shut down - I just let it timeout for now but I need to
work
<BR>this.
<BR>o A scheme to do the routing setup depending on which ISP I use!
<P><FONT COLOR="#CC0000">o Trouble shooting -</FONT>
<BR>I wanted to make sure the DHV ports were working. I figured I would
use a PC as a terminal, and login via the ttyS0 port.&nbsp; I have a few
BC03M and other home made null modem cables. I set up&nbsp; /dev/ttyS0
in my /etc/ttys file (I copied the tty00 entry and editted it to be ttyS0).
I did a kill -1 1 (to get init restarted and thus a getty for ttyS0). I
could not get a log in prompt on what I thought was the ttyS0 connector.<FONT COLOR="#00CC00"></FONT>
<P><FONT COLOR="#00CC00">That was the key!</FONT>
<P>I did not have the specs on the DHV cabling, and had picked the wrong
RS232 conncector (DB25) out of the 8 on the bulkhead. I got my hands on
a breakout box with LEDs. I found no DTR on the port I thought was ttyS0!
<BR>Then I found the right port. I also found that my cables did not pass
all the proper signals the right way. I rigged my breakout box as the null
modem for me.
<BR>Got a login prompt.
<BR>Then I hooked the up the modem.
<BR>Played with my scripts,
<BR>failed.
<BR>Did a dejanews search on netbsd and ppp. Found an Amiga posting that
had a script.
<BR>The quotes were different (I had used double quotes!) and when I changed
them I was suddenly almost online! I found I needed to add the delay in
the script and then I was online!!
<P>--
<BR>real address is shsrms at erols dot com
<BR>The Herbal Gypsy and the Tinker.
<BR>&nbsp;</HTML>
