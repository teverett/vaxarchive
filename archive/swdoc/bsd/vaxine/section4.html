<TITLE>4. Upgrading NetBSD/VAX to -Current</TITLE>

<H1>4. Upgrading NetBSD/VAX to -Current</H1>

<hr>

<A HREF="FAQ.html#toc4">Contents of this section</A>

<hr>

<H2>4.1 <A NAME="ss41"></A> Where can I find the Current NetBSD distribution?</H2>

A: Just about on every NetBSD mirror (and of course on ftp.netbsd.org) in 
the /pub/NetBSD/NetBSD-current/tar_files/src directory. Here's the full 
path to the Current distribution on a few sites:<p>

<ul>
<li><a href="ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-current/tar_files/src">
ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-current/tar_files/src</a>
<li><a href="ftp://ftp.luth.se/pub/NetBSD/NetBSD-current/tar_files/src">
ftp://ftp.luth.se/pub/NetBSD/NetBSD-current/tar_files/src</a>
<li><a href="ftp://ftp.bitcon.no/pub/NetBSD/NetBSD-current/tar_files/src">
ftp://ftp.bitcon.no/pub/NetBSD/NetBSD-current/tar_files/src</a>
<li><a href="ftp://ftp.cslab.vt.edu/pub/NetBSD/NetBSD-current/tar_files/src">
ftp://ftp.cslab.vt.edu/pub/NetBSD/NetBSD-current/tar_files/src</a>
<li><a href="ftp://gatekeeper.dec.com/pub/BSD/NetBSD/NetBSD-current/tar_files/src">
ftp://gatekeeper.dec.com/pub/BSD/NetBSD/NetBSD-current/tar_files/src</a>
</ul>

<H2>4.2 <A NAME="ss42"></A> What should I do before the upgrade?</H2>

Nothing here yet. I'm working on it...<p>

<H2>4.3 <A NAME="ss43"></A> How do I upgrade?</H2>

A: Very slowly ;-)<p>

Seriously though, here's what Bertram Barth 
&lt;bertram@ifib.uni-karlsruhe.de&gt; has to say on the subject (I'll 
include more detailed info once I've done the upgrade myself):<p>

<xmp>
------------------- Begin included message -------------------------------

Date: Sat, 13 Jan 1996 12:04:59 +0100
From: Bertram Barth <bertram@ifib.uni-karlsruhe.de>
To: port-vax@NetBSD.ORG
Cc: Dave McGuire <mcguire@rocinante.digex.net>
Subject: coming -current from binary snapshot

Dave McGuire writes:
> Folks,
>   Hey, me again.  I'm running (mostly) with the last binary snapshot,
> and would like to upgrade to -current.  I'm not sure what order to do
> this in, however.  Can someone shed some light on this for me?

Get and install the sources of NetBSD-current, setenv DESTDIR to a 
directory with enough space to hold usr/include and usr/lib, cd to 
/usr/src (or wherever you installed NetBSD-current into) and there
type 'make build' or 'make -i build' (I prefer the second one and 
pipe/tee the output into a log-file). Depending on your machine
and on the problems which arise during this build wait some time
(on my uVAX-II it takes some 5 to 10 days :) until the build gets
finished.
Meanwhile you should configure and compile a new kernel and copy
the new kernel into your root-directory.
If the build is finished without major problems, then setenv DESTDIR 
to an empty string, type 'make -i install' to install the new files
and reboot your machine with your new kernel.

At least that's what I do ...

Ciao,
        bertram

PS: you'll need ~100MB to hold NetBSD-current tree including the 
    compiled files and libraries.

------------------- End included message ---------------------------------
</xmp>

Here's some more info from Roger Ivie &lt;IVIE@cc.usu.edu&gt; regarding 
building a -Current kernel:<p>

<xmp>
------------------- Begin included message -------------------------------

Date: Sat, 16 Mar 1996 18:08:00 -0600 (MDT)
From: Roger Ivie <IVIE@cc.usu.edu>
To: port-vax@NetBSD.ORG
Subject: Amazing!

After much weeping, wailing, and gnashing of teeth, I have finally managed to
build a kernel. Here's what I did:

- Grabbed fresher sources from ftp.netbsd.org. The file I grabbed was dated
  March 10.
- Grabbed the sources to make from ftp.netbsd.org, built and installed it.
- Added set MACHINE_ARCH=vax to my .cshrc
- Added -fno-builtin to the makefile created by config
- Commented out a few references to DW780 not protected by #ifdef DW780 or
  somesuch. Since I don't have a /780, I had commented out the /780 line in
  the config file.
- Waited all day long...

My machine does have a DHV11 in it, but the new kernel doesn't detect it
at boot. Of course, I haven't the foggiest idea what address it's jumpered
for. I also don't have a cabinet kit, so I don't have any way to hook cables
to the bloody thing.

Roger Ivie
ivie@cc.usu.edu

------------------- End included message ---------------------------------
</xmp>

<H2>4.4 <A NAME="ss44"></A> The kernel build crashes. Now what?</H2>

A: Don't run 'make depend' as Ragge said on port-vax:<p>

<xmp>
------------------- Begin included message -------------------------------

Date: Wed, 3 Jan 1996 15:34:45 +0100 (MET)
From: Anders Magnusson <ragge@ludd.luth.se>
To: Luc Beurton <beurton@fnet.fr>
Cc: port-vax@NetBSD.ORG
Subject: Re: Compile a kernel

> 
> I try to compile a NetBSD-1.1 kernel on my MicroVax-II under NetBSD-1.0A,
> And I found some troubles around the Makefile.vax in sys/arch/vax/conf.
> So I change some little things to compile the kernel 
> 
> depend: param.c vnode_if.h
>       mkdep ${COPTS} ${.ALLSRC:M*.c} ioconf.c
>       mkdep -a -p ${INCLUDES} ${IDENT} ${PARAM} ????????
> 
Don't try to run 'make depend', it probably won't work. I have never
cared about it; it anyway takes about 3 hours to run it on a MicroVAX II.

> I looking for the file assym.S (like i386's port) or 
> genassym.c(like sparc's port).
> 
There are no :-) All locore startup are done in C. The only relevant
assembler files are intvec.s with SCB interrupt vectors, and subr.s
which has some miscellaneous subroutines, like sigcode.

-- Ragge

------------------- End included message ---------------------------------
</xmp>

<H2>4.5 <A NAME="ss45"></A> What do I need to do after upgrade?</H2>

Nothing here yet. I'm working on it...<p>

<HR><p>

Top of <A HREF="section5.html">next</A> chapter, 
Table of contents of <a href="FAQ.html#toc5">next chapter</a>.<br>
Table of contents of <A HREF="FAQ.html#toc4">this chapter</A>, 
General <A HREF="FAQ.html#toc">table of contents</A>.<p>

