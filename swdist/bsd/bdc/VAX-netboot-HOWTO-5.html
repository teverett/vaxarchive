<HTML>
<HEAD>
<TITLE>The VAX Network Booting HOWTO: Multiuser Configuration</TITLE>
</HEAD>
<BODY>
<A HREF="VAX-netboot-HOWTO-4.html">Previous</A>
<A HREF="VAX-netboot-HOWTO-6.html">Next</A>
<A HREF="VAX-netboot-HOWTO.html#toc5">Table of Contents</A>
<HR>
<H2><A NAME="multi-config"></A> <A NAME="s5">5. Multiuser Configuration</A></H2>

<P>In the last section we'd gotten you to the point where NetBSD had
successfully booted on your VAX system.  However, the client's system
configuration files are still in need of some changes.  These changes
allow the VAX to fully function as a multiuser system.  A system which
is running an array of network services, and one that provides remote
logins through telnet.</P>

<H2><A NAME="sing-mode"></A> <A NAME="ss5.1">5.1 Entering Single User Mode</A></H2>


<P>The last bit of information we received from our booting VAX was the
following.</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
/etc/rc.conf is not configured. Multiuser boot aborted.
Enter pathname of shell or RETURN for sh:
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Press the RETURN key.  You'll be prompted for your terminal type,
enter it and press RETURN.  You'll be dropped into single user mode on
the VAX.  If you're not sure of what terminal type you've got `vt100'
is a fairly safe value for many serial terminals as well as
communication software programs.</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
/etc/rc.conf is not configured. Multiuser boot aborted.
Enter pathname of shell or RETURN for sh:
Terminal type? vt100
Don't login as root, use the su command.
#
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>From here you've got access to all your standard Unix utilities.  You
may choose to edit the VAX client configuration files either here in
the privileged single user shell, or you may edit the configuration
files directly on the bootserver where the data resides.  I'll
continue the examples with editing the files from within the booted
VAX client.  Since you've put so much work into getting your machine
running, you may as well do something useful with right off.</P>


<H2><A NAME="mod-config"></A> <A NAME="ss5.2">5.2 Modifying The Configuration</A></H2>


<P><B>Creating The Device Files</B></P>
<P>One of the things that needs to be done is creating the device files
needed by the NetBSD/vax device drivers.  This is a simple operation
most commonly done with the <CODE>MAKEDEV</CODE> script.</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
# cd /dev
# ./MAKEDEV all
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P><B>Name Resolution</B></P>
<P>If you want your VAX to talk to other systems on your network by name,
you'll need to set up your name resolution facilities.  You're options
include using the hosts file, DNS, NIS, or any combination of these
facilities that suit your particular needs.</P>
<P>If you don't already have an NIS or DNS setup in place, then the
simplest of these options is to just add the host and IP addresses to
the <CODE>/etc/hosts</CODE> file.</P>
<P><B>Creating <CODE>/etc/fstab</CODE></B></P>
<P>Next we move on to creating a simple <CODE>/etc/fstab</CODE> file for the
booting VAX.  The file doesn't actually need to contain anything, it
just needs to exist.  A simple `touch /etc/fstab' will suffice.</P>
<P>However if you want the VAX to automatically make use of the swap file
at boot time, you'll need to place the swap file information a entry
in <CODE>/etc/fstab</CODE>.  You will also need to create a mount point for
the file.  I suggest using a directory named <CODE>/swap</CODE>.</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
# mkdir /swap
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Then edit the VAX client's <CODE>/etc/fstab</CODE> file to indicate where
the swap file is located and where it's being mounted to.</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
# Example /etc/fstab
bootserver:/export/vaxclient/swap none swap sw,nfsmntpt=/swap
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>You may also add entries for any NFS filesystems that you'd like
the VAX to mount during boot up.</P>
<P><B>Creating <CODE>/etc/myname</CODE>, <CODE>/etc/defaultdomain</CODE>, and 
<CODE>/etc/mygate</CODE></B></P>
<P>These files are optional, but are used to indicate the local hostname,
the host's domainname, and the default route for the VAX client.  In
this document's example, the file <CODE>/etc/myname</CODE> should contain
`vaxclient', the file <CODE>/etc/defaultdomain</CODE> should contain
`test.net', and <CODE>/etc/mygate</CODE> would contain `10.3.250.5' since
we're just talking to machines on the local network.</P>
<P>You may alternatively specify the hostname, domainname, and default
route in the <CODE>/etc/rc.conf file</CODE>.  See the next section for
some additional information on this file.</P>
<P><B>Modifying <CODE>/etc/rc.conf</CODE></B></P>
<P>The <CODE>/etc/rc.conf</CODE> file is a very important configuration file
which dictates the behavior of how your VAX boots into multiuser mode.
You should look through the file and set the available options such
that they reflect how you boot your system.  Here's a couple of
important options which should be set.</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
rc_configured=YES
nfs_client=YES
</PRE>
</CODE></BLOCKQUOTE>
</P>


<H2><A NAME="multi-boot"></A> <A NAME="ss5.3">5.3 Booting up Multiuser</A></H2>

<P>Having made some changes to the base NetBSD/vax installation, you
should now be ready to run your system in multiuser mode.  Prepare to
be dangerous.  Rebooting the system, you should see something along
the lines of the following.</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>

-ESA0
&gt;&gt; NetBSD/vax boot [980110 22:29] &lt;&lt;
: /netbsd
boot: client IP address: 10.3.250.5
boot: client name: vaxclient
root addr=10.3.250.2 path=/export/vaxclient/root
700416+38912+75784 start 0x9c078
Copyright (c) 1996, 1997 The NetBSD Foundation, Inc.  All rights reserved.
Copyright (c) 1982, 1986, 1989, 1991, 1993
    The Regents of the University of California.  All rights reserved.

NetBSD 1.3 (GENERIC) #1: Fri Jan 16 16:09:22 CET 1998
    ragge@multivac:/usr/hej/src/sys/arch/vax/compile/GENERIC

realmem = 16646144
avail mem = 12690432
Using 812 buffers containing 831488 bytes of memory.
backplane0 (root)
cpu0 at backplane0: MicroVAX 3100 (KA41)
vsbus0 at backplane0
le0 at vsbus0: address 08:00:2b:16:59:bb
le0: 32 receive buffers, 8 transmit buffers
probing for SCSI controller at 0x200c0080...
result: 0x0 (0)
SCSI controller found.
probing for SCSI controller at 0x200c0080...
result: 0x0 (0)
SCSI controller found.
ncr0 at vsbus0: scsi-id 7
scsibus0 at ncr0: 8 targets
probing for SCSI controller at 0x200c0180...      
result: 0x0 (0)                                   
SCSI controller found.                            
ncr1 at vsbus0: scsi-id 7                         
scsibus1 at ncr1: 8 targets
boot device: le0
nfs_boot: trying RARP (and RPC/bootparam)
nfs_boot: client_addr=0xa03fa14
nfs_boot: server_addr=0xa03fa0a
nfs_boot: hostname=vaxclient
root on bootserver:/export/vaxclient/root
root file system type: nfs
Automatic boot in progress: starting file system checks.
mount: /: unknown special file or file system.
setting tty flags
starting network
hostname: vaxclient
domainname: test.net
configuring network interfaces:.
swapctl: adding bootserver:/export/vaxclient/swap as \
  swap device at priority 0
starting system logger
checking for core dump...
savecore: no core dump (no dumpdev)
starting rpc daemons: portmap.
starting nfs daemons: nfsiod.
creating runtime link editor directory cache.
checking quotas: done.
building databases...
clearing /tmp
updating motd.
standard daemons: update cron.
starting network daemons: inetd.
starting local daemons:.
Fri Jan 23 17:10:09 PST 1998
Jan 23 17:10:11 vaxclient init: kernel security level changed from 0 to 1

NetBSD/vax (vaxclient) (console)

login:
</PRE>
</CODE></BLOCKQUOTE>
</P>




<HR>
<A HREF="VAX-netboot-HOWTO-4.html">Previous</A>
<A HREF="VAX-netboot-HOWTO-6.html">Next</A>
<A HREF="VAX-netboot-HOWTO.html#toc5">Table of Contents</A>
</BODY>
</HTML>
